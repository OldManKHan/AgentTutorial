# ç¬¬äºŒç« ï¼šMulti-Agent ç³»ç»Ÿ

> ğŸ¯ æœ¬ç« ç›®æ ‡ï¼šç†è§£ Multi-Agent ç³»ç»Ÿçš„è®¾è®¡åŸç†ï¼Œå­¦ä¼šæ„å»ºå¤šä¸ª Agent åä½œå®Œæˆå¤æ‚ä»»åŠ¡

## ä¸ºä»€ä¹ˆéœ€è¦ Multi-Agentï¼Ÿ

æƒ³è±¡ä½ æ˜¯ä¸€ä¸ªé¡¹ç›®ç»ç†ï¼Œé¢å¯¹ä¸€ä¸ªå¤æ‚çš„è½¯ä»¶å¼€å‘ä»»åŠ¡ã€‚ä½ ä¼šæ€ä¹ˆåšï¼Ÿ

- è‡ªå·±ä¸€ä¸ªäººå®Œæˆæ‰€æœ‰å·¥ä½œï¼ŸâŒ æ•ˆç‡ä½ï¼Œå®¹æ˜“å‡ºé”™
- ç»„å»ºå›¢é˜Ÿï¼Œåˆ†å·¥åä½œï¼Ÿâœ… å„å¸å…¶èŒï¼Œé«˜æ•ˆå®Œæˆ

AI Agent ä¹Ÿé¢ä¸´åŒæ ·çš„é€‰æ‹©ã€‚å½“ä»»åŠ¡å˜å¾—å¤æ‚æ—¶ï¼Œå•ä¸ª Agent å¯èƒ½ä¼šï¼š
- ä¸Šä¸‹æ–‡çª—å£ä¸å¤Ÿç”¨
- æ¨ç†é“¾æ¡è¿‡é•¿å¯¼è‡´é”™è¯¯ç´¯ç§¯
- æ— æ³•å¹¶è¡Œå¤„ç†å¤šä¸ªå­ä»»åŠ¡

**Multi-Agent ç³»ç»Ÿ**å°±æ˜¯è§£å†³æ–¹æ¡ˆï¼šè®©å¤šä¸ªä¸“ä¸šåŒ–çš„ Agent åä½œï¼Œå„è‡ªè´Ÿè´£æ“…é•¿çš„é¢†åŸŸã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å• Agent vs Multi-Agent                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  å• Agent æ¨¡å¼ï¼š                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚    ç”¨æˆ· â”€â”€â”€â”€â”€â”€â–¶ Agent â”€â”€â”€â”€â”€â”€â–¶ ç»“æœ                  â”‚   â”‚
â”‚  â”‚                  â”‚                                  â”‚   â”‚
â”‚  â”‚                  â”œâ”€â”€ ç†è§£éœ€æ±‚                       â”‚   â”‚
â”‚  â”‚                  â”œâ”€â”€ æœç´¢ä»£ç                        â”‚   â”‚
â”‚  â”‚                  â”œâ”€â”€ ç¼–å†™ä»£ç                        â”‚   â”‚
â”‚  â”‚                  â”œâ”€â”€ æµ‹è¯•éªŒè¯                       â”‚   â”‚
â”‚  â”‚                  â””â”€â”€ ç”Ÿæˆæ–‡æ¡£                       â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚    é—®é¢˜ï¼šä¸Šä¸‹æ–‡çˆ†ç‚¸ã€æ¨ç†é“¾è¿‡é•¿ã€æ— æ³•å¹¶è¡Œ           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  Multi-Agent æ¨¡å¼ï¼š                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚    ç”¨æˆ· â”€â”€â”€â”€â”€â”€â–¶ ä¸» Agentï¼ˆåè°ƒè€…ï¼‰                  â”‚   â”‚
â”‚  â”‚                    â”‚                                â”‚   â”‚
â”‚  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚  â”‚         â–¼          â–¼          â–¼                    â”‚   â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚  â”‚    â”‚ æœç´¢   â”‚ â”‚ ç¼–ç    â”‚ â”‚ æµ‹è¯•   â”‚               â”‚   â”‚
â”‚  â”‚    â”‚ Agent  â”‚ â”‚ Agent  â”‚ â”‚ Agent  â”‚               â”‚   â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚  â”‚         â”‚          â”‚          â”‚                    â”‚   â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚  â”‚                    â–¼                                â”‚   â”‚
â”‚  â”‚               æ±‡æ€»ç»“æœ â”€â”€â”€â”€â”€â”€â–¶ ç”¨æˆ·                 â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚    ä¼˜åŠ¿ï¼šä¸“ä¸šåˆ†å·¥ã€å¹¶è¡Œæ‰§è¡Œã€ä¸Šä¸‹æ–‡éš”ç¦»             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. Multi-Agent æ ¸å¿ƒæ¦‚å¿µ

### 1.1 ä»€ä¹ˆæ˜¯ Multi-Agent ç³»ç»Ÿï¼Ÿ

Multi-Agent ç³»ç»Ÿæ˜¯ç”±å¤šä¸ªè‡ªä¸» Agent ç»„æˆçš„ç³»ç»Ÿï¼Œè¿™äº› Agent é€šè¿‡åä½œæ¥å®Œæˆå•ä¸ª Agent éš¾ä»¥å®Œæˆçš„å¤æ‚ä»»åŠ¡ã€‚


**æ ¸å¿ƒç‰¹å¾**ï¼š

| ç‰¹å¾ | è¯´æ˜ |
|------|------|
| è‡ªä¸»æ€§ | æ¯ä¸ª Agent ç‹¬ç«‹å†³ç­–å’Œæ‰§è¡Œ |
| ä¸“ä¸šåŒ– | ä¸åŒ Agent æ“…é•¿ä¸åŒä»»åŠ¡ |
| åä½œæ€§ | Agent ä¹‹é—´å¯ä»¥é€šä¿¡å’Œåè°ƒ |
| åˆ†å¸ƒå¼ | ä»»åŠ¡å¯ä»¥å¹¶è¡Œå¤„ç† |

### 1.2 ä½•æ—¶é€‰æ‹© Multi-Agentï¼Ÿ

å¹¶éæ‰€æœ‰åœºæ™¯éƒ½éœ€è¦ Multi-Agentã€‚ä»¥ä¸‹æ˜¯é€‰æ‹©æŒ‡å—ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ¶æ„é€‰æ‹©å†³ç­–æ ‘                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                    ä»»åŠ¡å¤æ‚åº¦å¦‚ä½•ï¼Ÿ                         â”‚
â”‚                         â”‚                                   â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚            â–¼                         â–¼                     â”‚
â”‚         ç®€å•ä»»åŠ¡                  å¤æ‚ä»»åŠ¡                  â”‚
â”‚            â”‚                         â”‚                     â”‚
â”‚            â–¼                         â–¼                     â”‚
â”‚       å• Agent âœ…              éœ€è¦å¹¶è¡Œå¤„ç†ï¼Ÿ               â”‚
â”‚                                      â”‚                     â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚                         â–¼                         â–¼        â”‚
â”‚                        å¦                        æ˜¯        â”‚
â”‚                         â”‚                         â”‚        â”‚
â”‚                         â–¼                         â–¼        â”‚
â”‚                  ä¸Šä¸‹æ–‡å¤Ÿç”¨ï¼Ÿ              Multi-Agent âœ…   â”‚
â”‚                         â”‚                                  â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚            â–¼                         â–¼                     â”‚
â”‚           æ˜¯                        å¦                     â”‚
â”‚            â”‚                         â”‚                     â”‚
â”‚            â–¼                         â–¼                     â”‚
â”‚       å• Agent âœ…              Multi-Agent âœ…              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é€‚åˆ Multi-Agent çš„åœºæ™¯**ï¼š

| åœºæ™¯ | åŸå›  | ç¤ºä¾‹ |
|------|------|------|
| å¤æ‚ä»£ç é‡æ„ | éœ€è¦åŒæ—¶åˆ†æå¤šä¸ªæ–‡ä»¶ | é‡æ„æ•´ä¸ªæ¨¡å—çš„ API |
| ä»£ç å®¡æŸ¥ | ä¸åŒè§’åº¦çš„å®¡æŸ¥å¯ä»¥å¹¶è¡Œ | å®‰å…¨å®¡æŸ¥ + æ€§èƒ½å®¡æŸ¥ + é£æ ¼å®¡æŸ¥ |
| ç ”ç©¶ä»»åŠ¡ | éœ€è¦æœç´¢å¤šä¸ªæ¥æº | æŠ€æœ¯é€‰å‹è°ƒç ” |
| é•¿ä»»åŠ¡ | å• Agent ä¸Šä¸‹æ–‡ä¸å¤Ÿ | å¤§å‹åŠŸèƒ½å¼€å‘ |

**ä¸é€‚åˆ Multi-Agent çš„åœºæ™¯**ï¼š

| åœºæ™¯ | åŸå›  | å»ºè®® |
|------|------|------|
| ç®€å•é—®ç­” | å¼€é”€å¤§äºæ”¶ç›Š | å• Agent |
| å•æ–‡ä»¶ä¿®æ”¹ | ä¸éœ€è¦å¹¶è¡Œ | å• Agent |
| å¼ºä¾èµ–ä»»åŠ¡ | æ— æ³•å¹¶è¡Œ | å• Agent + å·¥å…· |

---

## 2. Agent é€šä¿¡æ¨¡å¼

Multi-Agent ç³»ç»Ÿä¸­ï¼ŒAgent ä¹‹é—´å¦‚ä½•é€šä¿¡æ˜¯æ ¸å¿ƒè®¾è®¡é—®é¢˜ã€‚å¸¸è§çš„é€šä¿¡æ¨¡å¼æœ‰ï¼š

### 2.1 å±‚çº§æ¨¡å¼ï¼ˆHierarchicalï¼‰

æœ€å¸¸è§çš„æ¨¡å¼ï¼šä¸€ä¸ªä¸» Agentï¼ˆåè°ƒè€…ï¼‰ç®¡ç†å¤šä¸ªå­ Agentã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å±‚çº§æ¨¡å¼æ¶æ„                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                    â”‚   ä¸» Agent  â”‚                         â”‚
â”‚                    â”‚  (åè°ƒè€…)   â”‚                         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                           â”‚                                 â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚              â”‚            â”‚            â”‚                   â”‚
â”‚              â–¼            â–¼            â–¼                   â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚        â”‚ å­Agent1 â”‚ â”‚ å­Agent2 â”‚ â”‚ å­Agent3 â”‚             â”‚
â”‚        â”‚ (æœç´¢)   â”‚ â”‚ (ç¼–ç )   â”‚ â”‚ (æµ‹è¯•)   â”‚             â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                             â”‚
â”‚  ç‰¹ç‚¹ï¼š                                                     â”‚
â”‚  â€¢ ä¸» Agent è´Ÿè´£ä»»åŠ¡åˆ†è§£å’Œç»“æœèšåˆ                         â”‚
â”‚  â€¢ å­ Agent åªä¸ä¸» Agent é€šä¿¡                              â”‚
â”‚  â€¢ å­ Agent ä¹‹é—´ä¸ç›´æ¥é€šä¿¡                                 â”‚
â”‚                                                             â”‚
â”‚  ä¼˜ç‚¹ï¼šç»“æ„æ¸…æ™°ã€æ˜“äºç®¡ç†ã€æƒé™å¯æ§                        â”‚
â”‚  ç¼ºç‚¹ï¼šä¸» Agent å¯èƒ½æˆä¸ºç“¶é¢ˆ                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**OpenCode é‡‡ç”¨çš„å°±æ˜¯å±‚çº§æ¨¡å¼**ï¼Œä¸» Agentï¼ˆbuildï¼‰å¯ä»¥é€šè¿‡ Task å·¥å…·å¯åŠ¨å­ Agentï¼ˆexploreã€general ç­‰ï¼‰ã€‚

### 2.2 å¯¹ç­‰æ¨¡å¼ï¼ˆPeer-to-Peerï¼‰

æ‰€æœ‰ Agent åœ°ä½å¹³ç­‰ï¼Œå¯ä»¥ç›¸äº’é€šä¿¡ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¯¹ç­‰æ¨¡å¼æ¶æ„                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚        â”‚ Agent A  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Agent B  â”‚                   â”‚
â”‚        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚             â”‚                    â”‚                          â”‚
â”‚             â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                          â”‚
â”‚             â””â”€â”€â”€â–ºâ”‚ Agent C  â”‚â—„â”€â”€â”€â”˜                          â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                             â”‚
â”‚  ç‰¹ç‚¹ï¼š                                                     â”‚
â”‚  â€¢ ä»»æ„ä¸¤ä¸ª Agent å¯ä»¥ç›´æ¥é€šä¿¡                             â”‚
â”‚  â€¢ æ²¡æœ‰ä¸­å¿ƒåè°ƒè€…                                          â”‚
â”‚  â€¢ éœ€è¦åè®®æ¥é¿å…å†²çª                                      â”‚
â”‚                                                             â”‚
â”‚  ä¼˜ç‚¹ï¼šçµæ´»ã€æ— å•ç‚¹ç“¶é¢ˆ                                    â”‚
â”‚  ç¼ºç‚¹ï¼šå¤æ‚åº¦é«˜ã€éš¾ä»¥è°ƒè¯•                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 å¹¿æ’­æ¨¡å¼ï¼ˆBroadcastï¼‰

ä¸€ä¸ª Agent çš„æ¶ˆæ¯å‘é€ç»™æ‰€æœ‰å…¶ä»– Agentã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¹¿æ’­æ¨¡å¼æ¶æ„                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                    â”‚ Agent A  â”‚                            â”‚
â”‚                    â”‚ (å¹¿æ’­è€…) â”‚                            â”‚
â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                         â”‚                                   â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚              â”‚          â”‚          â”‚                       â”‚
â”‚              â–¼          â–¼          â–¼                       â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚        â”‚ Agent B  â”‚ â”‚ Agent C  â”‚ â”‚ Agent D  â”‚             â”‚
â”‚        â”‚ (ç›‘å¬è€…) â”‚ â”‚ (ç›‘å¬è€…) â”‚ â”‚ (ç›‘å¬è€…) â”‚             â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                             â”‚
â”‚  ç‰¹ç‚¹ï¼š                                                     â”‚
â”‚  â€¢ æ¶ˆæ¯åŒæ—¶å‘é€ç»™æ‰€æœ‰ Agent                                â”‚
â”‚  â€¢ é€‚åˆéœ€è¦å…¨å±€åŒæ­¥çš„åœºæ™¯                                  â”‚
â”‚                                                             â”‚
â”‚  ä¼˜ç‚¹ï¼šä¿¡æ¯åŒæ­¥ã€ç®€å•                                      â”‚
â”‚  ç¼ºç‚¹ï¼šæ•ˆç‡ä½ã€å¯èƒ½äº§ç”Ÿå†—ä½™                                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 é»‘æ¿æ¨¡å¼ï¼ˆBlackboardï¼‰

æ‰€æœ‰ Agent å…±äº«ä¸€ä¸ª"é»‘æ¿"ï¼ˆå…±äº«çŠ¶æ€ï¼‰ï¼Œé€šè¿‡è¯»å†™é»‘æ¿æ¥åä½œã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é»‘æ¿æ¨¡å¼æ¶æ„                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Agent A  â”‚â”€â”€â”€â”€â–ºâ”‚                     â”‚â—„â”€â”€â”€â”€â”‚ Agent B  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚      é»‘æ¿          â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                   â”‚   (å…±äº«çŠ¶æ€)        â”‚                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                     â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Agent C  â”‚â”€â”€â”€â”€â–ºâ”‚  â€¢ ä»»åŠ¡åˆ—è¡¨        â”‚â—„â”€â”€â”€â”€â”‚ Agent D  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â€¢ ä¸­é—´ç»“æœ        â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                   â”‚  â€¢ å…¨å±€çŠ¶æ€        â”‚                   â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                             â”‚
â”‚  ç‰¹ç‚¹ï¼š                                                     â”‚
â”‚  â€¢ Agent ä¸ç›´æ¥é€šä¿¡ï¼Œé€šè¿‡é»‘æ¿äº¤æ¢ä¿¡æ¯                      â”‚
â”‚  â€¢ é»‘æ¿æ˜¯å”¯ä¸€çš„å…±äº«çŠ¶æ€                                    â”‚
â”‚                                                             â”‚
â”‚  ä¼˜ç‚¹ï¼šè§£è€¦ã€æ˜“äºæ‰©å±•                                      â”‚
â”‚  ç¼ºç‚¹ï¼šéœ€è¦å¤„ç†å¹¶å‘ã€çŠ¶æ€ç®¡ç†å¤æ‚                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é€šä¿¡æ¨¡å¼å¯¹æ¯”

| æ¨¡å¼ | å¤æ‚åº¦ | å¯æ‰©å±•æ€§ | é€‚ç”¨åœºæ™¯ |
|------|--------|----------|----------|
| å±‚çº§ | ä½ | ä¸­ | å¤§å¤šæ•°åœºæ™¯ï¼ŒOpenCode é‡‡ç”¨ |
| å¯¹ç­‰ | é«˜ | é«˜ | å¤æ‚åä½œã€æ— ä¸­å¿ƒåœºæ™¯ |
| å¹¿æ’­ | ä½ | ä½ | éœ€è¦å…¨å±€åŒæ­¥çš„åœºæ™¯ |
| é»‘æ¿ | ä¸­ | é«˜ | æ¾è€¦åˆã€å¼‚æ­¥åä½œ |

---

## 3. ä»»åŠ¡åˆ†è§£ä¸åˆ†é…

### 3.1 ä»»åŠ¡åˆ†è§£ç­–ç•¥

å°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¯ç‹¬ç«‹æ‰§è¡Œçš„å­ä»»åŠ¡æ˜¯ Multi-Agent çš„å…³é”®ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä»»åŠ¡åˆ†è§£ç¤ºä¾‹                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  åŸå§‹ä»»åŠ¡ï¼šé‡æ„ç”¨æˆ·è®¤è¯æ¨¡å—                                 â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ä»»åŠ¡åˆ†è§£                          â”‚   â”‚
â”‚  â”‚                       â”‚                              â”‚   â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚   â”‚
â”‚  â”‚     â”‚                 â”‚                 â”‚           â”‚   â”‚
â”‚  â”‚     â–¼                 â–¼                 â–¼           â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚
â”‚  â”‚ â”‚ åˆ†æ   â”‚      â”‚ å®ç°   â”‚      â”‚ éªŒè¯   â”‚         â”‚   â”‚
â”‚  â”‚ â”‚ é˜¶æ®µ   â”‚      â”‚ é˜¶æ®µ   â”‚      â”‚ é˜¶æ®µ   â”‚         â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚  â”‚     â”‚               â”‚               â”‚               â”‚   â”‚
â”‚  â”‚     â–¼               â–¼               â–¼               â”‚   â”‚
â”‚  â”‚ â€¢ æœç´¢ç°æœ‰ä»£ç   â€¢ ä¿®æ”¹è®¤è¯é€»è¾‘  â€¢ è¿è¡Œæµ‹è¯•          â”‚   â”‚
â”‚  â”‚ â€¢ åˆ†æä¾èµ–å…³ç³»  â€¢ æ›´æ–° API      â€¢ æ£€æŸ¥ç±»å‹          â”‚   â”‚
â”‚  â”‚ â€¢ è¯†åˆ«å½±å“èŒƒå›´  â€¢ å¤„ç†è¿ç§»      â€¢ ä»£ç å®¡æŸ¥          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  åˆ†è§£åŸåˆ™ï¼š                                                 â”‚
â”‚  1. å­ä»»åŠ¡åº”è¯¥ç›¸å¯¹ç‹¬ç«‹                                     â”‚
â”‚  2. å­ä»»åŠ¡ç²’åº¦é€‚ä¸­ï¼ˆä¸è¦å¤ªå¤§ä¹Ÿä¸è¦å¤ªå°ï¼‰                   â”‚
â”‚  3. æ˜ç¡®å­ä»»åŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»                               â”‚
â”‚  4. å¯å¹¶è¡Œçš„ä»»åŠ¡å°½é‡å¹¶è¡Œ                                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Agent èƒ½åŠ›åŒ¹é…

ä¸åŒçš„å­ä»»åŠ¡åº”è¯¥åˆ†é…ç»™æœ€åˆé€‚çš„ Agentã€‚


```typescript
// Agent èƒ½åŠ›å®šä¹‰ç¤ºä¾‹
interface AgentCapability {
  name: string
  description: string
  tools: string[]        // å¯ç”¨å·¥å…·
  strengths: string[]    // æ“…é•¿é¢†åŸŸ
  limitations: string[]  // é™åˆ¶
}

// OpenCode ä¸­çš„ Agent ç±»å‹
const agents: AgentCapability[] = [
  {
    name: "build",
    description: "ä¸» Agentï¼Œè´Ÿè´£ä»£ç ç¼–å†™å’Œä»»åŠ¡åè°ƒ",
    tools: ["read", "write", "bash", "task", "..."],
    strengths: ["ä»£ç ç¼–å†™", "ä»»åŠ¡è§„åˆ’", "å·¥å…·è°ƒç”¨"],
    limitations: ["ä¸Šä¸‹æ–‡æœ‰é™"],
  },
  {
    name: "explore",
    description: "ä¸“é—¨ç”¨äºä»£ç æœç´¢å’Œæ¢ç´¢",
    tools: ["glob", "grep", "read", "bash"],
    strengths: ["å¿«é€Ÿæœç´¢", "æ¨¡å¼åŒ¹é…", "ä»£ç å¯¼èˆª"],
    limitations: ["ä¸èƒ½ä¿®æ”¹æ–‡ä»¶"],
  },
  {
    name: "general",
    description: "é€šç”¨å­ Agentï¼Œç”¨äºå¹¶è¡Œæ‰§è¡Œä»»åŠ¡",
    tools: ["read", "write", "bash", "..."],
    strengths: ["å¹¶è¡Œæ‰§è¡Œ", "ç‹¬ç«‹ä¸Šä¸‹æ–‡"],
    limitations: ["ä¸èƒ½åˆ›å»ºå­ä»»åŠ¡"],
  },
]
```

### 3.3 åŠ¨æ€ä»»åŠ¡åˆ†é…

ä¸» Agent æ ¹æ®ä»»åŠ¡ç‰¹ç‚¹åŠ¨æ€é€‰æ‹©å­ Agentï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŠ¨æ€ä»»åŠ¡åˆ†é…æµç¨‹                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. åˆ†æä»»åŠ¡                                                â”‚
â”‚     â”‚                                                       â”‚
â”‚     â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ä»»åŠ¡ï¼šæ‰¾åˆ°æ‰€æœ‰ä½¿ç”¨ deprecated API çš„æ–‡ä»¶           â”‚   â”‚
â”‚  â”‚  ç‰¹ç‚¹ï¼šæœç´¢ä»»åŠ¡ã€åªè¯»ã€éœ€è¦æ¨¡å¼åŒ¹é…                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚     â”‚                                                       â”‚
â”‚     â–¼                                                       â”‚
â”‚  2. åŒ¹é… Agent                                              â”‚
â”‚     â”‚                                                       â”‚
â”‚     â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  explore Agent âœ…                                   â”‚   â”‚
â”‚  â”‚  â€¢ æ“…é•¿æœç´¢ âœ“                                       â”‚   â”‚
â”‚  â”‚  â€¢ æœ‰ glob/grep å·¥å…· âœ“                              â”‚   â”‚
â”‚  â”‚  â€¢ ä¸éœ€è¦å†™æƒé™ âœ“                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚     â”‚                                                       â”‚
â”‚     â–¼                                                       â”‚
â”‚  3. åˆ†é…ä»»åŠ¡                                                â”‚
â”‚     â”‚                                                       â”‚
â”‚     â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Task(                                              â”‚   â”‚
â”‚  â”‚    subagent_type: "explore",                        â”‚   â”‚
â”‚  â”‚    description: "æŸ¥æ‰¾ deprecated API ä½¿ç”¨",         â”‚   â”‚
â”‚  â”‚    prompt: "æœç´¢æ‰€æœ‰ä½¿ç”¨ oldAPI() çš„æ–‡ä»¶..."        â”‚   â”‚
â”‚  â”‚  )                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ç»“æœèšåˆä¸å†²çªè§£å†³

### 4.1 ç»“æœèšåˆç­–ç•¥

å½“å¤šä¸ªå­ Agent è¿”å›ç»“æœæ—¶ï¼Œä¸» Agent éœ€è¦èšåˆè¿™äº›ç»“æœã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç»“æœèšåˆç­–ç•¥                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ç­–ç•¥ 1ï¼šåˆå¹¶ï¼ˆMergeï¼‰                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Agent A: æ‰¾åˆ°æ–‡ä»¶ [a.ts, b.ts]                     â”‚   â”‚
â”‚  â”‚  Agent B: æ‰¾åˆ°æ–‡ä»¶ [c.ts, d.ts]                     â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚   â”‚
â”‚  â”‚  åˆå¹¶ç»“æœ: [a.ts, b.ts, c.ts, d.ts]                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  ç­–ç•¥ 2ï¼šæŠ•ç¥¨ï¼ˆVotingï¼‰                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Agent A: å»ºè®®ä½¿ç”¨æ–¹æ¡ˆ X                            â”‚   â”‚
â”‚  â”‚  Agent B: å»ºè®®ä½¿ç”¨æ–¹æ¡ˆ X                            â”‚   â”‚
â”‚  â”‚  Agent C: å»ºè®®ä½¿ç”¨æ–¹æ¡ˆ Y                            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚   â”‚
â”‚  â”‚  æŠ•ç¥¨ç»“æœ: æ–¹æ¡ˆ X (2:1)                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  ç­–ç•¥ 3ï¼šä¼˜å…ˆçº§ï¼ˆPriorityï¼‰                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å®‰å…¨ Agent: å‘ç°é«˜å±æ¼æ´ âš ï¸                        â”‚   â”‚
â”‚  â”‚  æ€§èƒ½ Agent: å»ºè®®ä¼˜åŒ–å¾ªç¯                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚   â”‚
â”‚  â”‚  ä¼˜å…ˆå¤„ç†: å®‰å…¨é—®é¢˜ï¼ˆä¼˜å…ˆçº§æ›´é«˜ï¼‰                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  ç­–ç•¥ 4ï¼šæ‘˜è¦ï¼ˆSummaryï¼‰                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å¤šä¸ª Agent è¿”å›è¯¦ç»†åˆ†ææŠ¥å‘Š                        â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚   â”‚
â”‚  â”‚  ä¸» Agent ç”Ÿæˆç»¼åˆæ‘˜è¦å‘ˆç°ç»™ç”¨æˆ·                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 å†²çªè§£å†³

å½“å­ Agent çš„ç»“æœç›¸äº’çŸ›ç›¾æ—¶ï¼Œéœ€è¦å†²çªè§£å†³æœºåˆ¶ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å†²çªè§£å†³æœºåˆ¶                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  å†²çªç±»å‹ 1ï¼šç»“è®ºå†²çª                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Agent A: "è¿™ä¸ªå‡½æ•°æ˜¯å®‰å…¨çš„"                        â”‚   â”‚
â”‚  â”‚  Agent B: "è¿™ä¸ªå‡½æ•°æœ‰å®‰å…¨æ¼æ´"                      â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  è§£å†³æ–¹æ¡ˆï¼š                                         â”‚   â”‚
â”‚  â”‚  â€¢ è¯·æ±‚æ›´å¤šè¯æ®                                     â”‚   â”‚
â”‚  â”‚  â€¢ å¼•å…¥ç¬¬ä¸‰ä¸ª Agent ä»²è£                            â”‚   â”‚
â”‚  â”‚  â€¢ ä¿å®ˆå¤„ç†ï¼ˆå‡è®¾æœ‰é—®é¢˜ï¼‰                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  å†²çªç±»å‹ 2ï¼šèµ„æºå†²çª                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Agent A: æƒ³ä¿®æ”¹ config.ts ç¬¬ 10 è¡Œ                 â”‚   â”‚
â”‚  â”‚  Agent B: æƒ³ä¿®æ”¹ config.ts ç¬¬ 10 è¡Œ                 â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  è§£å†³æ–¹æ¡ˆï¼š                                         â”‚   â”‚
â”‚  â”‚  â€¢ ä¸²è¡Œæ‰§è¡Œï¼ˆä¸€ä¸ªå®Œæˆåå¦ä¸€ä¸ªå†æ‰§è¡Œï¼‰               â”‚   â”‚
â”‚  â”‚  â€¢ åˆå¹¶ä¿®æ”¹ï¼ˆå¦‚æœå…¼å®¹ï¼‰                             â”‚   â”‚
â”‚  â”‚  â€¢ äººå·¥ä»‹å…¥                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  å†²çªç±»å‹ 3ï¼šä¼˜å…ˆçº§å†²çª                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Agent A: "åº”è¯¥å…ˆä¿®å¤ bug"                          â”‚   â”‚
â”‚  â”‚  Agent B: "åº”è¯¥å…ˆæ·»åŠ åŠŸèƒ½"                          â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚  è§£å†³æ–¹æ¡ˆï¼š                                         â”‚   â”‚
â”‚  â”‚  â€¢ é¢„å®šä¹‰ä¼˜å…ˆçº§è§„åˆ™                                 â”‚   â”‚
â”‚  â”‚  â€¢ è¯¢é—®ç”¨æˆ·                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. å­ Agent æƒé™ç®¡ç†

åœ¨ Multi-Agent ç³»ç»Ÿä¸­ï¼Œæƒé™ç®¡ç†è‡³å…³é‡è¦ã€‚å­ Agent ä¸åº”è¯¥æ‹¥æœ‰ä¸ä¸» Agent ç›¸åŒçš„æƒé™ã€‚

### 5.1 æƒé™éš”ç¦»åŸåˆ™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æƒé™éš”ç¦»è®¾è®¡                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ä¸» Agent (build)                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æƒé™ï¼š                                             â”‚   â”‚
â”‚  â”‚  â€¢ read: âœ… å…è®¸                                    â”‚   â”‚
â”‚  â”‚  â€¢ write: âœ… å…è®¸                                   â”‚   â”‚
â”‚  â”‚  â€¢ bash: âœ… å…è®¸                                    â”‚   â”‚
â”‚  â”‚  â€¢ task: âœ… å…è®¸ï¼ˆå¯ä»¥åˆ›å»ºå­ Agentï¼‰                â”‚   â”‚
â”‚  â”‚  â€¢ todowrite: âœ… å…è®¸                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â”‚ åˆ›å»ºå­ Agent                     â”‚
â”‚                          â–¼                                  â”‚
â”‚  å­ Agent (explore)                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æƒé™ï¼ˆå—é™ï¼‰ï¼š                                     â”‚   â”‚
â”‚  â”‚  â€¢ read: âœ… å…è®¸                                    â”‚   â”‚
â”‚  â”‚  â€¢ write: âŒ ç¦æ­¢                                   â”‚   â”‚
â”‚  â”‚  â€¢ bash: âœ… å…è®¸ï¼ˆåªè¯»å‘½ä»¤ï¼‰                        â”‚   â”‚
â”‚  â”‚  â€¢ task: âŒ ç¦æ­¢ï¼ˆä¸èƒ½åˆ›å»ºå­å­ Agentï¼‰              â”‚   â”‚
â”‚  â”‚  â€¢ todowrite: âŒ ç¦æ­¢                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  è®¾è®¡åŸåˆ™ï¼š                                                 â”‚
â”‚  1. æœ€å°æƒé™åŸåˆ™ï¼šåªç»™å¿…è¦çš„æƒé™                           â”‚
â”‚  2. é˜²æ­¢é€’å½’ï¼šå­ Agent ä¸èƒ½åˆ›å»ºå­ Agent                    â”‚
â”‚  3. éš”ç¦»å‰¯ä½œç”¨ï¼šæœç´¢ Agent ä¸èƒ½ä¿®æ”¹æ–‡ä»¶                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 æƒé™é…ç½®ç¤ºä¾‹

```typescript
// OpenCode ä¸­çš„æƒé™é…ç½®
const exploreAgentPermissions = {
  // å…è®¸çš„å·¥å…·
  "*": "deny",           // é»˜è®¤ç¦æ­¢æ‰€æœ‰
  grep: "allow",         // å…è®¸æœç´¢
  glob: "allow",         // å…è®¸æ–‡ä»¶åŒ¹é…
  list: "allow",         // å…è®¸åˆ—ç›®å½•
  bash: "allow",         // å…è®¸ bashï¼ˆä½†æœ‰é™åˆ¶ï¼‰
  read: "allow",         // å…è®¸è¯»æ–‡ä»¶
  webfetch: "allow",     // å…è®¸ç½‘ç»œè¯·æ±‚
  websearch: "allow",    // å…è®¸ç½‘ç»œæœç´¢
  codesearch: "allow",   // å…è®¸ä»£ç æœç´¢
}

// å­ Agent åˆ›å»ºæ—¶çš„æƒé™é™åˆ¶
const subAgentRestrictions = [
  { permission: "todowrite", pattern: "*", action: "deny" },
  { permission: "todoread", pattern: "*", action: "deny" },
  { permission: "task", pattern: "*", action: "deny" },  // å…³é”®ï¼šç¦æ­¢åˆ›å»ºå­ä»»åŠ¡
]
```


---

## 6. OpenCode å®è·µæ¡ˆä¾‹

è®©æˆ‘ä»¬æ·±å…¥åˆ†æ OpenCode æ˜¯å¦‚ä½•å®ç° Multi-Agent ç³»ç»Ÿçš„ã€‚

### 6.1 Agent å®šä¹‰ä¸ç®¡ç†

OpenCode åœ¨ `packages/opencode/src/agent/agent.ts` ä¸­å®šä¹‰äº† Agent ç³»ç»Ÿï¼š

```typescript
// packages/opencode/src/agent/agent.tsï¼ˆç®€åŒ–ç‰ˆï¼‰

export namespace Agent {
  // Agent ä¿¡æ¯çš„ Schema å®šä¹‰
  export const Info = z.object({
    name: z.string(),                    // Agent åç§°
    description: z.string().optional(),  // æè¿°ï¼ˆç”¨äº Task å·¥å…·é€‰æ‹©ï¼‰
    mode: z.enum(["subagent", "primary", "all"]),  // æ¨¡å¼
    native: z.boolean().optional(),      // æ˜¯å¦å†…ç½®
    hidden: z.boolean().optional(),      // æ˜¯å¦éšè—
    permission: PermissionNext.Ruleset,  // æƒé™è§„åˆ™é›†
    model: z.object({                    // å¯é€‰çš„ä¸“ç”¨æ¨¡å‹
      modelID: z.string(),
      providerID: z.string(),
    }).optional(),
    prompt: z.string().optional(),       // è‡ªå®šä¹‰ System Prompt
    steps: z.number().int().positive().optional(),  // æœ€å¤§æ­¥æ•°é™åˆ¶
  })

  // å†…ç½® Agent å®šä¹‰
  const result: Record<string, Info> = {
    // ä¸» Agentï¼šè´Ÿè´£ä»£ç ç¼–å†™å’Œä»»åŠ¡åè°ƒ
    build: {
      name: "build",
      mode: "primary",
      native: true,
      permission: PermissionNext.merge(defaults, user),
    },
    
    // é€šç”¨å­ Agentï¼šç”¨äºå¹¶è¡Œæ‰§è¡Œå¤æ‚ä»»åŠ¡
    general: {
      name: "general",
      description: `General-purpose agent for researching complex questions 
                    and executing multi-step tasks. Use this agent to execute 
                    multiple units of work in parallel.`,
      mode: "subagent",
      native: true,
      hidden: true,  // éšè—ï¼Œä¸ç›´æ¥æš´éœ²ç»™ç”¨æˆ·
      permission: PermissionNext.merge(
        defaults,
        PermissionNext.fromConfig({
          todoread: "deny",   // ç¦æ­¢è¯»å– TODO
          todowrite: "deny",  // ç¦æ­¢å†™å…¥ TODO
        }),
        user,
      ),
    },
    
    // æ¢ç´¢ Agentï¼šä¸“é—¨ç”¨äºä»£ç æœç´¢
    explore: {
      name: "explore",
      description: `Fast agent specialized for exploring codebases. 
                    Use this when you need to quickly find files by patterns,
                    search code for keywords, or answer questions about the codebase.`,
      mode: "subagent",
      native: true,
      prompt: PROMPT_EXPLORE,  // ä¸“ç”¨çš„ System Prompt
      permission: PermissionNext.merge(
        defaults,
        PermissionNext.fromConfig({
          "*": "deny",         // é»˜è®¤ç¦æ­¢æ‰€æœ‰
          grep: "allow",       // åªå…è®¸æœç´¢ç›¸å…³å·¥å…·
          glob: "allow",
          list: "allow",
          bash: "allow",
          read: "allow",
          webfetch: "allow",
          websearch: "allow",
          codesearch: "allow",
        }),
        user,
      ),
    },
    
    // å‹ç¼© Agentï¼šç”¨äºç”Ÿæˆå¯¹è¯æ‘˜è¦
    compaction: {
      name: "compaction",
      mode: "primary",
      native: true,
      hidden: true,
      prompt: PROMPT_COMPACTION,
      permission: PermissionNext.merge(
        defaults,
        PermissionNext.fromConfig({ "*": "deny" }),  // ç¦æ­¢æ‰€æœ‰å·¥å…·
        user,
      ),
    },
  }
}
```

**å…³é”®è®¾è®¡ç‚¹**ï¼š

1. **æ¨¡å¼åŒºåˆ†**ï¼š`mode` å­—æ®µåŒºåˆ†ä¸» Agentï¼ˆprimaryï¼‰å’Œå­ Agentï¼ˆsubagentï¼‰
2. **æƒé™éš”ç¦»**ï¼šæ¯ä¸ª Agent æœ‰ç‹¬ç«‹çš„æƒé™é…ç½®
3. **ä¸“ç”¨ Prompt**ï¼šå­ Agent å¯ä»¥æœ‰ä¸“é—¨çš„ System Prompt
4. **éšè—æœºåˆ¶**ï¼š`hidden: true` çš„ Agent ä¸ç›´æ¥æš´éœ²ç»™ç”¨æˆ·

### 6.2 Task å·¥å…·å®ç°

Task å·¥å…·æ˜¯ Multi-Agent çš„æ ¸å¿ƒï¼Œå®ƒå…è®¸ä¸» Agent åˆ›å»ºå’Œç®¡ç†å­ Agentã€‚

```typescript
// packages/opencode/src/tool/task.tsï¼ˆç®€åŒ–ç‰ˆï¼‰

export const TaskTool = Tool.define("task", async () => {
  // è·å–æ‰€æœ‰å¯ç”¨çš„å­ Agent
  const agents = await Agent.list().then((x) => 
    x.filter((a) => a.mode !== "primary")  // æ’é™¤ä¸» Agent
  )
  
  // åŠ¨æ€ç”Ÿæˆå·¥å…·æè¿°ï¼ŒåŒ…å«å¯ç”¨ Agent åˆ—è¡¨
  const description = DESCRIPTION.replace(
    "{agents}",
    agents.map((a) => 
      `- ${a.name}: ${a.description ?? "This subagent should only be called manually."}`
    ).join("\n"),
  )
  
  return {
    description,
    parameters: z.object({
      description: z.string().describe("A short (3-5 words) description of the task"),
      prompt: z.string().describe("The task for the agent to perform"),
      subagent_type: z.string().describe("The type of specialized agent to use"),
      session_id: z.string().describe("Existing Task session to continue").optional(),
    }),
    
    async execute(params, ctx) {
      // 1. æƒé™æ£€æŸ¥
      await ctx.ask({
        permission: "task",
        patterns: [params.subagent_type],
        metadata: {
          description: params.description,
          subagent_type: params.subagent_type,
        },
      })

      // 2. è·å–æŒ‡å®šçš„ Agent
      const agent = await Agent.get(params.subagent_type)
      if (!agent) throw new Error(`Unknown agent type: ${params.subagent_type}`)
      
      // 3. åˆ›å»ºå­ä¼šè¯ï¼ˆå…³é”®ï¼šæƒé™é™åˆ¶ï¼‰
      const session = await Session.create({
        parentID: ctx.sessionID,  // å…³è”çˆ¶ä¼šè¯
        title: params.description + ` (@${agent.name} subagent)`,
        permission: [
          // ç¦æ­¢å­ Agent åˆ›å»ºå­ä»»åŠ¡ï¼ˆé˜²æ­¢é€’å½’ï¼‰
          { permission: "todowrite", pattern: "*", action: "deny" },
          { permission: "todoread", pattern: "*", action: "deny" },
          { permission: "task", pattern: "*", action: "deny" },
        ],
      })
      
      // 4. è®¾ç½®å…ƒæ•°æ®ï¼ˆç”¨äº UI æ˜¾ç¤ºï¼‰
      ctx.metadata({
        title: params.description,
        metadata: { sessionId: session.id },
      })
      
      // 5. ç›‘å¬å­ Agent çš„å·¥å…·è°ƒç”¨ï¼ˆå®æ—¶æ›´æ–°çŠ¶æ€ï¼‰
      const parts: Record<string, { id: string; tool: string; state: any }> = {}
      const unsub = Bus.subscribe(MessageV2.Event.PartUpdated, async (evt) => {
        if (evt.properties.part.sessionID !== session.id) return
        if (evt.properties.part.type !== "tool") return
        
        const part = evt.properties.part
        parts[part.id] = {
          id: part.id,
          tool: part.tool,
          state: {
            status: part.state.status,
            title: part.state.status === "completed" ? part.state.title : undefined,
          },
        }
        
        // æ›´æ–°ä¸» Agent çš„æ˜¾ç¤º
        ctx.metadata({
          title: params.description,
          metadata: {
            summary: Object.values(parts),
            sessionId: session.id,
          },
        })
      })
      
      // 6. æ‰§è¡Œå­ Agent
      const result = await SessionPrompt.prompt({
        sessionID: session.id,
        model: agent.model ?? { /* ç»§æ‰¿çˆ¶ Agent çš„æ¨¡å‹ */ },
        agent: agent.name,
        tools: {
          todowrite: false,  // ç¦ç”¨è¿™äº›å·¥å…·
          todoread: false,
          task: false,       // å…³é”®ï¼šç¦æ­¢åˆ›å»ºå­ä»»åŠ¡
        },
        parts: await SessionPrompt.resolvePromptParts(params.prompt),
      })
      
      unsub()  // å–æ¶ˆè®¢é˜…
      
      // 7. è¿”å›ç»“æœ
      const text = result.parts.findLast((x) => x.type === "text")?.text ?? ""
      return {
        title: params.description,
        metadata: { sessionId: session.id },
        output: text + `\n\n<task_metadata>\nsession_id: ${session.id}\n</task_metadata>`,
      }
    },
  }
})
```

**å…³é”®è®¾è®¡ç‚¹**ï¼š

1. **åŠ¨æ€ Agent åˆ—è¡¨**ï¼šå·¥å…·æè¿°ä¸­åŒ…å«æ‰€æœ‰å¯ç”¨å­ Agent çš„è¯´æ˜
2. **æƒé™ç»§æ‰¿ä¸é™åˆ¶**ï¼šå­ä¼šè¯ç»§æ‰¿çˆ¶ä¼šè¯æƒé™ï¼Œä½†é¢å¤–ç¦æ­¢æŸäº›æ“ä½œ
3. **é˜²æ­¢é€’å½’**ï¼š`task: false` ç¡®ä¿å­ Agent ä¸èƒ½åˆ›å»ºå­å­ Agent
4. **å®æ—¶çŠ¶æ€åŒæ­¥**ï¼šé€šè¿‡äº‹ä»¶æ€»çº¿ç›‘å¬å­ Agent çš„å·¥å…·è°ƒç”¨
5. **ä¼šè¯å…³è”**ï¼š`parentID` å»ºç«‹çˆ¶å­ä¼šè¯å…³ç³»

### 6.3 Explore Agent çš„ Prompt è®¾è®¡

ä¸“ä¸šåŒ–å­ Agent çš„å…³é”®æ˜¯ç²¾å¿ƒè®¾è®¡çš„ System Promptï¼š

```typescript
// packages/opencode/src/agent/prompt/explore.txt

// Explore Agent çš„ System Prompt
const PROMPT_EXPLORE = `
You are a file search specialist. You excel at thoroughly navigating 
and exploring codebases.

Your strengths:
- Rapidly finding files using glob patterns
- Searching code and text with powerful regex patterns
- Reading and analyzing file contents

Guidelines:
- Use Glob for broad file pattern matching
- Use Grep for searching file contents with regex
- Use Read when you know the specific file path you need to read
- Use Bash for file operations like copying, moving, or listing directory contents
- Adapt your search approach based on the thoroughness level specified by the caller
- Return file paths as absolute paths in your final response
- For clear communication, avoid using emojis
- Do not create any files, or run bash commands that modify the user's system state

Complete the user's search request efficiently and report your findings clearly.
`
```

**Prompt è®¾è®¡è¦ç‚¹**ï¼š

1. **æ˜ç¡®è§’è‰²**ï¼šå¼€å¤´å°±è¯´æ˜æ˜¯"æ–‡ä»¶æœç´¢ä¸“å®¶"
2. **åˆ—å‡ºèƒ½åŠ›**ï¼šå‘Šè¯‰ Agent å®ƒæ“…é•¿ä»€ä¹ˆ
3. **ä½¿ç”¨æŒ‡å—**ï¼šä»€ä¹ˆæƒ…å†µç”¨ä»€ä¹ˆå·¥å…·
4. **é™åˆ¶è¯´æ˜**ï¼šæ˜ç¡®ç¦æ­¢ä¿®æ”¹æ–‡ä»¶
5. **è¾“å‡ºè¦æ±‚**ï¼šè¿”å›ç»å¯¹è·¯å¾„ã€æ¸…æ™°æŠ¥å‘Š

### 6.4 å¹¶è¡Œä»»åŠ¡æ‰§è¡Œ

Task å·¥å…·æ”¯æŒå¹¶è¡Œå¯åŠ¨å¤šä¸ªå­ Agentï¼š

```typescript
// ä¸» Agent å¯ä»¥åœ¨ä¸€æ¡æ¶ˆæ¯ä¸­å¯åŠ¨å¤šä¸ªå­ Agent
// è¿™äº›å­ Agent ä¼šå¹¶è¡Œæ‰§è¡Œ

// ç¤ºä¾‹ï¼šå¹¶è¡Œæœç´¢å¤šä¸ªæ¨¡å¼
const tasks = [
  Task({
    subagent_type: "explore",
    description: "æŸ¥æ‰¾ API ç«¯ç‚¹",
    prompt: "æœç´¢æ‰€æœ‰ @Get, @Post è£…é¥°å™¨çš„ä½¿ç”¨",
  }),
  Task({
    subagent_type: "explore", 
    description: "æŸ¥æ‰¾æ•°æ®åº“æ¨¡å‹",
    prompt: "æœç´¢æ‰€æœ‰ @Entity è£…é¥°å™¨çš„ä½¿ç”¨",
  }),
  Task({
    subagent_type: "explore",
    description: "æŸ¥æ‰¾é…ç½®æ–‡ä»¶",
    prompt: "æœç´¢æ‰€æœ‰ .config.ts æ–‡ä»¶",
  }),
]

// è¿™ä¸‰ä¸ªä»»åŠ¡ä¼šå¹¶è¡Œæ‰§è¡Œï¼Œå¤§å¤§æé«˜æ•ˆç‡
```


---

## 7. åŠ¨æ‰‹å®éªŒ

### å®éªŒ 1ï¼šç†è§£ Agent æ¨¡å¼

**ç›®æ ‡**ï¼šç†è§£ä¸» Agent å’Œå­ Agent çš„åŒºåˆ«

**æ­¥éª¤**ï¼š

1. æŸ¥çœ‹ OpenCode çš„ Agent é…ç½®ï¼š

```typescript
// experiment-1.ts
// æ¨¡æ‹Ÿ OpenCode çš„ Agent å®šä¹‰

type AgentMode = "primary" | "subagent" | "all"

interface AgentInfo {
  name: string
  mode: AgentMode
  description?: string
  canCreateSubtasks: boolean
  tools: string[]
}

const agents: AgentInfo[] = [
  {
    name: "build",
    mode: "primary",
    description: "ä¸» Agentï¼Œè´Ÿè´£ä»£ç ç¼–å†™",
    canCreateSubtasks: true,
    tools: ["read", "write", "bash", "task", "glob", "grep"],
  },
  {
    name: "explore",
    mode: "subagent",
    description: "æœç´¢ä¸“å®¶ï¼Œå¿«é€ŸæŸ¥æ‰¾ä»£ç ",
    canCreateSubtasks: false,  // å­ Agent ä¸èƒ½åˆ›å»ºå­ä»»åŠ¡
    tools: ["read", "bash", "glob", "grep"],  // æ²¡æœ‰ write å’Œ task
  },
  {
    name: "general",
    mode: "subagent",
    description: "é€šç”¨å­ Agentï¼Œå¹¶è¡Œæ‰§è¡Œä»»åŠ¡",
    canCreateSubtasks: false,
    tools: ["read", "write", "bash", "glob", "grep"],  // æ²¡æœ‰ task
  },
]

// åˆ†æ Agent èƒ½åŠ›
function analyzeAgent(agent: AgentInfo) {
  console.log(`\n=== ${agent.name} ===`)
  console.log(`æ¨¡å¼: ${agent.mode}`)
  console.log(`æè¿°: ${agent.description}`)
  console.log(`å¯åˆ›å»ºå­ä»»åŠ¡: ${agent.canCreateSubtasks}`)
  console.log(`å¯ç”¨å·¥å…·: ${agent.tools.join(", ")}`)
  
  // èƒ½åŠ›åˆ†æ
  const canWrite = agent.tools.includes("write")
  const canSearch = agent.tools.includes("glob") && agent.tools.includes("grep")
  const canDelegate = agent.tools.includes("task")
  
  console.log(`èƒ½åŠ›: ${[
    canWrite ? "å†™æ–‡ä»¶" : null,
    canSearch ? "æœç´¢ä»£ç " : null,
    canDelegate ? "å§”æ´¾ä»»åŠ¡" : null,
  ].filter(Boolean).join(", ")}`)
}

agents.forEach(analyzeAgent)
```

2. è¿è¡Œå¹¶è§‚å¯Ÿè¾“å‡ºï¼š

```bash
bun run experiment-1.ts
```

3. æ€è€ƒï¼šä¸ºä»€ä¹ˆ explore Agent æ²¡æœ‰ write æƒé™ï¼Ÿ

### å®éªŒ 2ï¼šæ¨¡æ‹Ÿä»»åŠ¡åˆ†é…

**ç›®æ ‡**ï¼šç†è§£ä¸» Agent å¦‚ä½•é€‰æ‹©å­ Agent

**æ­¥éª¤**ï¼š

1. å®ç°ç®€å•çš„ä»»åŠ¡åˆ†é…é€»è¾‘ï¼š

```typescript
// experiment-2.ts
interface Task {
  description: string
  requiresWrite: boolean
  requiresSearch: boolean
  canParallelize: boolean
}

interface Agent {
  name: string
  canWrite: boolean
  canSearch: boolean
  description: string
}

const availableAgents: Agent[] = [
  { name: "explore", canWrite: false, canSearch: true, description: "æœç´¢ä¸“å®¶" },
  { name: "general", canWrite: true, canSearch: true, description: "é€šç”¨æ‰§è¡Œ" },
]

function selectAgent(task: Task): Agent | null {
  console.log(`\nä»»åŠ¡: ${task.description}`)
  console.log(`éœ€è¦å†™æƒé™: ${task.requiresWrite}`)
  console.log(`éœ€è¦æœç´¢: ${task.requiresSearch}`)
  
  for (const agent of availableAgents) {
    // æ£€æŸ¥èƒ½åŠ›åŒ¹é…
    if (task.requiresWrite && !agent.canWrite) {
      console.log(`  âŒ ${agent.name}: ç¼ºå°‘å†™æƒé™`)
      continue
    }
    if (task.requiresSearch && !agent.canSearch) {
      console.log(`  âŒ ${agent.name}: ç¼ºå°‘æœç´¢èƒ½åŠ›`)
      continue
    }
    
    console.log(`  âœ… é€‰æ‹©: ${agent.name} (${agent.description})`)
    return agent
  }
  
  console.log(`  âš ï¸ æ²¡æœ‰åˆé€‚çš„ Agent`)
  return null
}

// æµ‹è¯•ä¸åŒä»»åŠ¡
const tasks: Task[] = [
  { description: "æŸ¥æ‰¾æ‰€æœ‰ TODO æ³¨é‡Š", requiresWrite: false, requiresSearch: true, canParallelize: true },
  { description: "é‡æ„å‡½æ•°å‘½å", requiresWrite: true, requiresSearch: true, canParallelize: false },
  { description: "æœç´¢ API ç«¯ç‚¹", requiresWrite: false, requiresSearch: true, canParallelize: true },
]

tasks.forEach(selectAgent)
```

2. è¿è¡Œå¹¶è§‚å¯Ÿé€‰æ‹©é€»è¾‘

3. æ€è€ƒï¼šå¦‚ä½•ä¼˜åŒ–é€‰æ‹©ç®—æ³•ï¼Ÿ

### å®éªŒ 3ï¼šæ¨¡æ‹Ÿå¹¶è¡Œæ‰§è¡Œ

**ç›®æ ‡**ï¼šç†è§£å¹¶è¡Œä»»åŠ¡æ‰§è¡Œçš„ä¼˜åŠ¿

**æ­¥éª¤**ï¼š

1. å¯¹æ¯”ä¸²è¡Œå’Œå¹¶è¡Œæ‰§è¡Œï¼š

```typescript
// experiment-3.ts
async function simulateTask(name: string, duration: number): Promise<string> {
  console.log(`[${new Date().toISOString()}] å¼€å§‹: ${name}`)
  await new Promise(resolve => setTimeout(resolve, duration))
  console.log(`[${new Date().toISOString()}] å®Œæˆ: ${name}`)
  return `${name} çš„ç»“æœ`
}

async function serialExecution() {
  console.log("\n=== ä¸²è¡Œæ‰§è¡Œ ===")
  const start = Date.now()
  
  const result1 = await simulateTask("æœç´¢ API", 1000)
  const result2 = await simulateTask("æœç´¢æ¨¡å‹", 1000)
  const result3 = await simulateTask("æœç´¢é…ç½®", 1000)
  
  const duration = Date.now() - start
  console.log(`æ€»è€—æ—¶: ${duration}ms`)
  return [result1, result2, result3]
}

async function parallelExecution() {
  console.log("\n=== å¹¶è¡Œæ‰§è¡Œ ===")
  const start = Date.now()
  
  const results = await Promise.all([
    simulateTask("æœç´¢ API", 1000),
    simulateTask("æœç´¢æ¨¡å‹", 1000),
    simulateTask("æœç´¢é…ç½®", 1000),
  ])
  
  const duration = Date.now() - start
  console.log(`æ€»è€—æ—¶: ${duration}ms`)
  return results
}

async function main() {
  await serialExecution()
  await parallelExecution()
}

main()
```

2. è¿è¡Œå¹¶å¯¹æ¯”è€—æ—¶ï¼š

```bash
bun run experiment-3.ts
```

3. è§‚å¯Ÿï¼šå¹¶è¡Œæ‰§è¡Œåº”è¯¥å¿«çº¦ 3 å€

---

## 8. å®æˆ˜é¡¹ç›®ï¼šä»£ç å®¡æŸ¥å›¢é˜Ÿ Multi-Agent

### é¡¹ç›®ç›®æ ‡

æ„å»ºä¸€ä¸ª"ä»£ç å®¡æŸ¥å›¢é˜Ÿ"ï¼Œç”±å¤šä¸ªä¸“ä¸šåŒ– Agent ç»„æˆï¼š
- **å®‰å…¨å®¡æŸ¥ Agent**ï¼šæ£€æŸ¥å®‰å…¨æ¼æ´
- **æ€§èƒ½å®¡æŸ¥ Agent**ï¼šæ£€æŸ¥æ€§èƒ½é—®é¢˜
- **é£æ ¼å®¡æŸ¥ Agent**ï¼šæ£€æŸ¥ä»£ç é£æ ¼
- **åè°ƒ Agent**ï¼šæ±‡æ€»å®¡æŸ¥ç»“æœ

### é¡¹ç›®æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä»£ç å®¡æŸ¥å›¢é˜Ÿæ¶æ„                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚   åè°ƒ Agent    â”‚                     â”‚
â”‚                    â”‚  (Coordinator)  â”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                             â”‚                               â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚              â”‚              â”‚              â”‚               â”‚
â”‚              â–¼              â–¼              â–¼               â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚        â”‚ å®‰å…¨å®¡æŸ¥ â”‚  â”‚ æ€§èƒ½å®¡æŸ¥ â”‚  â”‚ é£æ ¼å®¡æŸ¥ â”‚           â”‚
â”‚        â”‚  Agent   â”‚  â”‚  Agent   â”‚  â”‚  Agent   â”‚           â”‚
â”‚        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â”‚
â”‚             â”‚             â”‚             â”‚                  â”‚
â”‚             â–¼             â–¼             â–¼                  â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚        â”‚ å®‰å…¨é—®é¢˜ â”‚  â”‚ æ€§èƒ½é—®é¢˜ â”‚  â”‚ é£æ ¼é—®é¢˜ â”‚           â”‚
â”‚        â”‚   åˆ—è¡¨   â”‚  â”‚   åˆ—è¡¨   â”‚  â”‚   åˆ—è¡¨   â”‚           â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                             â”‚                               â”‚
â”‚                             â–¼                               â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚   ç»¼åˆæŠ¥å‘Š      â”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®ç°æ­¥éª¤

#### æ­¥éª¤ 1ï¼šåˆ›å»ºé¡¹ç›®ç»“æ„

```bash
mkdir code-review-team
cd code-review-team
bun init -y
bun add openai zod
```

```
code-review-team/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts           # å…¥å£
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ coordinator.ts # åè°ƒ Agent
â”‚   â”‚   â”œâ”€â”€ security.ts    # å®‰å…¨å®¡æŸ¥ Agent
â”‚   â”‚   â”œâ”€â”€ performance.ts # æ€§èƒ½å®¡æŸ¥ Agent
â”‚   â”‚   â””â”€â”€ style.ts       # é£æ ¼å®¡æŸ¥ Agent
â”‚   â”œâ”€â”€ types.ts           # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ utils.ts           # å·¥å…·å‡½æ•°
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

#### æ­¥éª¤ 2ï¼šå®šä¹‰ç±»å‹

```typescript
// src/types.ts
export interface ReviewIssue {
  severity: "critical" | "warning" | "info"
  category: "security" | "performance" | "style"
  line?: number
  message: string
  suggestion?: string
}

export interface ReviewResult {
  agent: string
  issues: ReviewIssue[]
  summary: string
}

export interface CodeReviewRequest {
  code: string
  language: string
  filename: string
}

export interface Agent {
  name: string
  description: string
  review(request: CodeReviewRequest): Promise<ReviewResult>
}
```

#### æ­¥éª¤ 3ï¼šå®ç°å®‰å…¨å®¡æŸ¥ Agent

```typescript
// src/agents/security.ts
import OpenAI from "openai"
import { Agent, CodeReviewRequest, ReviewResult, ReviewIssue } from "../types"

export class SecurityAgent implements Agent {
  name = "security"
  description = "æ£€æŸ¥ä»£ç ä¸­çš„å®‰å…¨æ¼æ´"
  private client: OpenAI
  
  constructor(apiKey: string) {
    this.client = new OpenAI({ apiKey })
  }
  
  async review(request: CodeReviewRequest): Promise<ReviewResult> {
    const systemPrompt = `ä½ æ˜¯ä¸€ä¸ªå®‰å…¨å®¡æŸ¥ä¸“å®¶ã€‚åˆ†æä»£ç ä¸­çš„å®‰å…¨é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼š
- SQL æ³¨å…¥
- XSS æ”»å‡»
- æ•æ„Ÿä¿¡æ¯æ³„éœ²
- ä¸å®‰å…¨çš„ä¾èµ–
- æƒé™é—®é¢˜

è¿”å› JSON æ ¼å¼çš„å®¡æŸ¥ç»“æœã€‚`

    const response = await this.client.chat.completions.create({
      model: "gpt-4o-mini",
      messages: [
        { role: "system", content: systemPrompt },
        { role: "user", content: `å®¡æŸ¥ä»¥ä¸‹ ${request.language} ä»£ç ï¼š\n\n${request.code}` },
      ],
      response_format: { type: "json_object" },
    })
    
    const result = JSON.parse(response.choices[0].message.content || "{}")
    
    return {
      agent: this.name,
      issues: (result.issues || []).map((issue: any) => ({
        ...issue,
        category: "security" as const,
      })),
      summary: result.summary || "å®‰å…¨å®¡æŸ¥å®Œæˆ",
    }
  }
}
```

#### æ­¥éª¤ 4ï¼šå®ç°æ€§èƒ½å®¡æŸ¥ Agent

```typescript
// src/agents/performance.ts
import OpenAI from "openai"
import { Agent, CodeReviewRequest, ReviewResult } from "../types"

export class PerformanceAgent implements Agent {
  name = "performance"
  description = "æ£€æŸ¥ä»£ç ä¸­çš„æ€§èƒ½é—®é¢˜"
  private client: OpenAI
  
  constructor(apiKey: string) {
    this.client = new OpenAI({ apiKey })
  }
  
  async review(request: CodeReviewRequest): Promise<ReviewResult> {
    const systemPrompt = `ä½ æ˜¯ä¸€ä¸ªæ€§èƒ½ä¼˜åŒ–ä¸“å®¶ã€‚åˆ†æä»£ç ä¸­çš„æ€§èƒ½é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼š
- ä¸å¿…è¦çš„å¾ªç¯
- å†…å­˜æ³„æ¼é£é™©
- ä½æ•ˆçš„ç®—æ³•
- é‡å¤è®¡ç®—
- é˜»å¡æ“ä½œ

è¿”å› JSON æ ¼å¼çš„å®¡æŸ¥ç»“æœã€‚`

    const response = await this.client.chat.completions.create({
      model: "gpt-4o-mini",
      messages: [
        { role: "system", content: systemPrompt },
        { role: "user", content: `å®¡æŸ¥ä»¥ä¸‹ ${request.language} ä»£ç ï¼š\n\n${request.code}` },
      ],
      response_format: { type: "json_object" },
    })
    
    const result = JSON.parse(response.choices[0].message.content || "{}")
    
    return {
      agent: this.name,
      issues: (result.issues || []).map((issue: any) => ({
        ...issue,
        category: "performance" as const,
      })),
      summary: result.summary || "æ€§èƒ½å®¡æŸ¥å®Œæˆ",
    }
  }
}
```

#### æ­¥éª¤ 5ï¼šå®ç°é£æ ¼å®¡æŸ¥ Agent

```typescript
// src/agents/style.ts
import OpenAI from "openai"
import { Agent, CodeReviewRequest, ReviewResult } from "../types"

export class StyleAgent implements Agent {
  name = "style"
  description = "æ£€æŸ¥ä»£ç é£æ ¼å’Œå¯è¯»æ€§"
  private client: OpenAI
  
  constructor(apiKey: string) {
    this.client = new OpenAI({ apiKey })
  }
  
  async review(request: CodeReviewRequest): Promise<ReviewResult> {
    const systemPrompt = `ä½ æ˜¯ä¸€ä¸ªä»£ç é£æ ¼ä¸“å®¶ã€‚åˆ†æä»£ç çš„å¯è¯»æ€§å’Œé£æ ¼é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼š
- å‘½åè§„èŒƒ
- ä»£ç ç»“æ„
- æ³¨é‡Šè´¨é‡
- å‡½æ•°é•¿åº¦
- ä»£ç é‡å¤

è¿”å› JSON æ ¼å¼çš„å®¡æŸ¥ç»“æœã€‚`

    const response = await this.client.chat.completions.create({
      model: "gpt-4o-mini",
      messages: [
        { role: "system", content: systemPrompt },
        { role: "user", content: `å®¡æŸ¥ä»¥ä¸‹ ${request.language} ä»£ç ï¼š\n\n${request.code}` },
      ],
      response_format: { type: "json_object" },
    })
    
    const result = JSON.parse(response.choices[0].message.content || "{}")
    
    return {
      agent: this.name,
      issues: (result.issues || []).map((issue: any) => ({
        ...issue,
        category: "style" as const,
      })),
      summary: result.summary || "é£æ ¼å®¡æŸ¥å®Œæˆ",
    }
  }
}
```


#### æ­¥éª¤ 6ï¼šå®ç°åè°ƒ Agent

```typescript
// src/agents/coordinator.ts
import OpenAI from "openai"
import { Agent, CodeReviewRequest, ReviewResult, ReviewIssue } from "../types"
import { SecurityAgent } from "./security"
import { PerformanceAgent } from "./performance"
import { StyleAgent } from "./style"

export class CoordinatorAgent {
  private agents: Agent[]
  private client: OpenAI
  
  constructor(apiKey: string) {
    this.client = new OpenAI({ apiKey })
    this.agents = [
      new SecurityAgent(apiKey),
      new PerformanceAgent(apiKey),
      new StyleAgent(apiKey),
    ]
  }
  
  async review(request: CodeReviewRequest): Promise<{
    results: ReviewResult[]
    summary: string
    criticalCount: number
    warningCount: number
    infoCount: number
  }> {
    console.log(`\nğŸ” å¼€å§‹ä»£ç å®¡æŸ¥: ${request.filename}`)
    console.log(`ğŸ“ è¯­è¨€: ${request.language}`)
    console.log(`ğŸ“Š ä»£ç è¡Œæ•°: ${request.code.split("\n").length}`)
    
    // å¹¶è¡Œæ‰§è¡Œæ‰€æœ‰å®¡æŸ¥ Agent
    console.log("\nâ³ å¹¶è¡Œæ‰§è¡Œå®¡æŸ¥...")
    const startTime = Date.now()
    
    const results = await Promise.all(
      this.agents.map(async (agent) => {
        console.log(`  ğŸ¤– ${agent.name} Agent å¼€å§‹å®¡æŸ¥...`)
        const result = await agent.review(request)
        console.log(`  âœ… ${agent.name} Agent å®Œæˆï¼Œå‘ç° ${result.issues.length} ä¸ªé—®é¢˜`)
        return result
      })
    )
    
    const duration = Date.now() - startTime
    console.log(`\nâ±ï¸ å®¡æŸ¥è€—æ—¶: ${duration}ms`)
    
    // èšåˆç»“æœ
    const allIssues = results.flatMap(r => r.issues)
    const criticalCount = allIssues.filter(i => i.severity === "critical").length
    const warningCount = allIssues.filter(i => i.severity === "warning").length
    const infoCount = allIssues.filter(i => i.severity === "info").length
    
    // ç”Ÿæˆç»¼åˆæ‘˜è¦
    const summary = await this.generateSummary(results, allIssues)
    
    return {
      results,
      summary,
      criticalCount,
      warningCount,
      infoCount,
    }
  }
  
  private async generateSummary(
    results: ReviewResult[], 
    allIssues: ReviewIssue[]
  ): Promise<string> {
    const summaryPrompt = `åŸºäºä»¥ä¸‹å®¡æŸ¥ç»“æœï¼Œç”Ÿæˆä¸€ä¸ªç®€æ´çš„ç»¼åˆæ‘˜è¦ï¼š

${results.map(r => `${r.agent}: ${r.summary}`).join("\n")}

æ€»é—®é¢˜æ•°: ${allIssues.length}
- ä¸¥é‡: ${allIssues.filter(i => i.severity === "critical").length}
- è­¦å‘Š: ${allIssues.filter(i => i.severity === "warning").length}
- ä¿¡æ¯: ${allIssues.filter(i => i.severity === "info").length}

è¯·ç”¨ä¸­æ–‡ç”Ÿæˆ 2-3 å¥è¯çš„æ‘˜è¦ã€‚`

    const response = await this.client.chat.completions.create({
      model: "gpt-4o-mini",
      messages: [
        { role: "user", content: summaryPrompt },
      ],
      max_tokens: 200,
    })
    
    return response.choices[0].message.content || "å®¡æŸ¥å®Œæˆ"
  }
}
```

#### æ­¥éª¤ 7ï¼šåˆ›å»ºå…¥å£æ–‡ä»¶

```typescript
// src/index.ts
import { CoordinatorAgent } from "./agents/coordinator"

async function main() {
  const apiKey = process.env.OPENAI_API_KEY
  if (!apiKey) {
    console.error("è¯·è®¾ç½® OPENAI_API_KEY ç¯å¢ƒå˜é‡")
    process.exit(1)
  }
  
  const coordinator = new CoordinatorAgent(apiKey)
  
  // ç¤ºä¾‹ä»£ç 
  const sampleCode = `
function getUserData(userId) {
  // ç›´æ¥æ‹¼æ¥ SQLï¼Œå­˜åœ¨æ³¨å…¥é£é™©
  const query = "SELECT * FROM users WHERE id = " + userId
  const result = db.query(query)
  
  // åœ¨å¾ªç¯ä¸­è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ï¼Œæ€§èƒ½é—®é¢˜
  for (let i = 0; i < result.friends.length; i++) {
    const friend = db.query("SELECT * FROM users WHERE id = " + result.friends[i])
    result.friendsData.push(friend)
  }
  
  // è¿”å›åŒ…å«å¯†ç çš„å®Œæ•´ç”¨æˆ·å¯¹è±¡
  return result
}
`

  const result = await coordinator.review({
    code: sampleCode,
    language: "JavaScript",
    filename: "user-service.js",
  })
  
  console.log("\n" + "=".repeat(60))
  console.log("ğŸ“‹ ç»¼åˆå®¡æŸ¥æŠ¥å‘Š")
  console.log("=".repeat(60))
  
  console.log(`\nğŸ“Š é—®é¢˜ç»Ÿè®¡:`)
  console.log(`  ğŸ”´ ä¸¥é‡: ${result.criticalCount}`)
  console.log(`  ğŸŸ¡ è­¦å‘Š: ${result.warningCount}`)
  console.log(`  ğŸ”µ ä¿¡æ¯: ${result.infoCount}`)
  
  console.log(`\nğŸ“ ç»¼åˆæ‘˜è¦:`)
  console.log(`  ${result.summary}`)
  
  console.log(`\nğŸ“‘ è¯¦ç»†é—®é¢˜:`)
  for (const agentResult of result.results) {
    console.log(`\n  [${agentResult.agent}]`)
    for (const issue of agentResult.issues) {
      const icon = issue.severity === "critical" ? "ğŸ”´" : 
                   issue.severity === "warning" ? "ğŸŸ¡" : "ğŸ”µ"
      console.log(`    ${icon} ${issue.message}`)
      if (issue.suggestion) {
        console.log(`       ğŸ’¡ ${issue.suggestion}`)
      }
    }
  }
}

main()
```

### è¿è¡Œé¡¹ç›®

```bash
export OPENAI_API_KEY="your-api-key"
bun run src/index.ts
```

### æ‰©å±•æ€è€ƒ

1. **å¦‚ä½•æ·»åŠ æ›´å¤šå®¡æŸ¥ç»´åº¦ï¼Ÿ**
   - æ·»åŠ æµ‹è¯•è¦†ç›–ç‡å®¡æŸ¥ Agent
   - æ·»åŠ æ–‡æ¡£å®Œæ•´æ€§å®¡æŸ¥ Agent

2. **å¦‚ä½•å¤„ç†å®¡æŸ¥å†²çªï¼Ÿ**
   - å®‰å…¨ Agent è¯´è¦åŠ éªŒè¯ï¼Œæ€§èƒ½ Agent è¯´éªŒè¯å¤ªæ…¢
   - å®ç°ä¼˜å…ˆçº§æœºåˆ¶æˆ–äººå·¥ä»²è£

3. **å¦‚ä½•ä¼˜åŒ–å®¡æŸ¥æ•ˆç‡ï¼Ÿ**
   - ç¼“å­˜ç›¸ä¼¼ä»£ç çš„å®¡æŸ¥ç»“æœ
   - å¢é‡å®¡æŸ¥ï¼ˆåªå®¡æŸ¥å˜æ›´éƒ¨åˆ†ï¼‰

4. **å¦‚ä½•é›†æˆåˆ° CI/CDï¼Ÿ**
   - ä½œä¸º GitHub Action è¿è¡Œ
   - è‡ªåŠ¨è¯„è®º PR

---

## 9. çŸ¥è¯†è¡¥å……

### ç›¸å…³è®ºæ–‡

| è®ºæ–‡ | ä¸»é¢˜ | å…³é”®è´¡çŒ® |
|------|------|----------|
| [AutoGen](https://arxiv.org/abs/2308.08155) | Multi-Agent å¯¹è¯ | å¯å®šåˆ¶çš„å¤š Agent å¯¹è¯æ¡†æ¶ |
| [MetaGPT](https://arxiv.org/abs/2308.00352) | è½¯ä»¶å¼€å‘ Agent | æ¨¡æ‹Ÿè½¯ä»¶å…¬å¸çš„ Multi-Agent ç³»ç»Ÿ |
| [ChatDev](https://arxiv.org/abs/2307.07924) | åä½œå¼€å‘ | è™šæ‹Ÿè½¯ä»¶å…¬å¸çš„ Agent åä½œ |
| [AgentVerse](https://arxiv.org/abs/2308.10848) | Agent åä½œ | å¤š Agent åä½œæ¡†æ¶ |

### æ¨èé˜…è¯»

1. **LangGraph æ–‡æ¡£**
   - https://langchain-ai.github.io/langgraph/
   - æ„å»ºæœ‰çŠ¶æ€çš„ Multi-Agent åº”ç”¨

2. **CrewAI æ–‡æ¡£**
   - https://docs.crewai.com/
   - è§’è‰²æ‰®æ¼”çš„ Multi-Agent æ¡†æ¶

3. **AutoGen æ–‡æ¡£**
   - https://microsoft.github.io/autogen/
   - å¾®è½¯çš„ Multi-Agent å¯¹è¯æ¡†æ¶

### å¼€æºé¡¹ç›®å‚è€ƒ

| é¡¹ç›® | ç‰¹ç‚¹ | é“¾æ¥ |
|------|------|------|
| OpenCode | ç”Ÿäº§çº§å®ç°ï¼Œå±‚çº§æ¨¡å¼ | æœ¬æ•™ç¨‹ä¸»è¦å‚è€ƒ |
| AutoGen | çµæ´»çš„å¯¹è¯æ¨¡å¼ | https://github.com/microsoft/autogen |
| MetaGPT | è½¯ä»¶å¼€å‘æµç¨‹ | https://github.com/geekan/MetaGPT |
| CrewAI | è§’è‰²æ‰®æ¼”æ¡†æ¶ | https://github.com/joaomdmoura/crewAI |

---

## 10. æœ¬ç« å°ç»“

### æ ¸å¿ƒæ¦‚å¿µå›é¡¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Multi-Agent æ ¸å¿ƒæ¦‚å¿µ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ä¸ºä»€ä¹ˆéœ€è¦ Multi-Agent                                     â”‚
â”‚  â”œâ”€â”€ å¤æ‚ä»»åŠ¡éœ€è¦ä¸“ä¸šåˆ†å·¥                                  â”‚
â”‚  â”œâ”€â”€ å¹¶è¡Œæ‰§è¡Œæé«˜æ•ˆç‡                                      â”‚
â”‚  â””â”€â”€ ä¸Šä¸‹æ–‡éš”ç¦»é¿å…æº¢å‡º                                    â”‚
â”‚                                                             â”‚
â”‚  é€šä¿¡æ¨¡å¼                                                   â”‚
â”‚  â”œâ”€â”€ å±‚çº§æ¨¡å¼ï¼šä¸» Agent åè°ƒå­ Agentï¼ˆOpenCode é‡‡ç”¨ï¼‰      â”‚
â”‚  â”œâ”€â”€ å¯¹ç­‰æ¨¡å¼ï¼šAgent ä¹‹é—´å¹³ç­‰é€šä¿¡                          â”‚
â”‚  â”œâ”€â”€ å¹¿æ’­æ¨¡å¼ï¼šæ¶ˆæ¯å‘é€ç»™æ‰€æœ‰ Agent                        â”‚
â”‚  â””â”€â”€ é»‘æ¿æ¨¡å¼ï¼šé€šè¿‡å…±äº«çŠ¶æ€åä½œ                            â”‚
â”‚                                                             â”‚
â”‚  ä»»åŠ¡åˆ†è§£ä¸åˆ†é…                                             â”‚
â”‚  â”œâ”€â”€ å°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºç‹¬ç«‹å­ä»»åŠ¡                            â”‚
â”‚  â”œâ”€â”€ æ ¹æ® Agent èƒ½åŠ›åŒ¹é…ä»»åŠ¡                               â”‚
â”‚  â””â”€â”€ å¯å¹¶è¡Œçš„ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œ                                  â”‚
â”‚                                                             â”‚
â”‚  ç»“æœèšåˆä¸å†²çªè§£å†³                                         â”‚
â”‚  â”œâ”€â”€ åˆå¹¶ã€æŠ•ç¥¨ã€ä¼˜å…ˆçº§ã€æ‘˜è¦                              â”‚
â”‚  â””â”€â”€ å†²çªæ£€æµ‹ä¸è§£å†³æœºåˆ¶                                    â”‚
â”‚                                                             â”‚
â”‚  æƒé™ç®¡ç†                                                   â”‚
â”‚  â”œâ”€â”€ æœ€å°æƒé™åŸåˆ™                                          â”‚
â”‚  â”œâ”€â”€ é˜²æ­¢é€’å½’ï¼ˆå­ Agent ä¸èƒ½åˆ›å»ºå­ Agentï¼‰                 â”‚
â”‚  â””â”€â”€ éš”ç¦»å‰¯ä½œç”¨                                            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### OpenCode ä»£ç å¯¹ç…§è¡¨

| æ¦‚å¿µ | OpenCode æ–‡ä»¶ | å…³é”®å‡½æ•°/ç±» |
|------|---------------|-------------|
| Agent å®šä¹‰ | `src/agent/agent.ts` | `Agent.Info`, `Agent.get()` |
| Agent åˆ—è¡¨ | `src/agent/agent.ts` | `Agent.list()` |
| Task å·¥å…· | `src/tool/task.ts` | `TaskTool` |
| æƒé™ç³»ç»Ÿ | `src/permission/next.ts` | `PermissionNext` |
| å­ä¼šè¯åˆ›å»º | `src/session/index.ts` | `Session.create()` |
| Explore Prompt | `src/agent/prompt/explore.txt` | - |

### æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬ç« å­¦ä¹ åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

- [ ] è§£é‡Šä»€ä¹ˆæ˜¯ Multi-Agent ç³»ç»Ÿä»¥åŠä½•æ—¶ä½¿ç”¨
- [ ] æè¿°è‡³å°‘ 3 ç§ Agent é€šä¿¡æ¨¡å¼åŠå…¶ä¼˜ç¼ºç‚¹
- [ ] ç†è§£ä»»åŠ¡åˆ†è§£å’Œ Agent èƒ½åŠ›åŒ¹é…çš„åŸåˆ™
- [ ] è§£é‡Šç»“æœèšåˆå’Œå†²çªè§£å†³çš„ç­–ç•¥
- [ ] ç†è§£å­ Agent æƒé™ç®¡ç†çš„é‡è¦æ€§
- [ ] é˜…è¯»å¹¶ç†è§£ OpenCode çš„ Task å·¥å…·å®ç°
- [ ] è®¾è®¡ä¸€ä¸ªç®€å•çš„ Multi-Agent ç³»ç»Ÿæ¶æ„
- [ ] å®ç°ä¸€ä¸ªåŸºæœ¬çš„ä»£ç å®¡æŸ¥å›¢é˜Ÿ

### å¸¸è§é—®é¢˜

**Q: ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨ Multi-Agent è€Œä¸æ˜¯å• Agentï¼Ÿ**

A: å½“ä»»åŠ¡æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶è€ƒè™‘ Multi-Agentï¼š
- ä»»åŠ¡å¯ä»¥åˆ†è§£ä¸ºç‹¬ç«‹å­ä»»åŠ¡
- å­ä»»åŠ¡å¯ä»¥å¹¶è¡Œæ‰§è¡Œ
- å• Agent ä¸Šä¸‹æ–‡ä¸å¤Ÿç”¨
- éœ€è¦ä¸åŒä¸“ä¸šèƒ½åŠ›

**Q: å¦‚ä½•é˜²æ­¢å­ Agent åˆ›å»ºæ— é™é€’å½’ï¼Ÿ**

A: OpenCode çš„åšæ³•æ˜¯åœ¨åˆ›å»ºå­ä¼šè¯æ—¶ç¦ç”¨ `task` å·¥å…·ï¼š
```typescript
permission: [
  { permission: "task", pattern: "*", action: "deny" },
]
```

**Q: å­ Agent çš„ç»“æœå¦‚ä½•ä¼ å›ä¸» Agentï¼Ÿ**

A: å­ Agent çš„æœ€ç»ˆæ–‡æœ¬è¾“å‡ºä¼šä½œä¸º Task å·¥å…·çš„è¿”å›å€¼ä¼ å›ä¸» Agentã€‚ä¸» Agent å¯ä»¥æ ¹æ®è¿™ä¸ªç»“æœç»§ç»­å¤„ç†ã€‚

**Q: å¦‚ä½•å¤„ç†å­ Agent æ‰§è¡Œå¤±è´¥ï¼Ÿ**

A: 
- è®¾ç½®è¶…æ—¶æœºåˆ¶
- æ•è·é”™è¯¯å¹¶è¿”å›é”™è¯¯ä¿¡æ¯
- ä¸» Agent æ ¹æ®é”™è¯¯å†³å®šæ˜¯å¦é‡è¯•æˆ–é‡‡ç”¨å¤‡é€‰æ–¹æ¡ˆ

---

## å¯¼èˆª

- [â† ä¸Šä¸€ç« ï¼šä¸Šä¸‹æ–‡å·¥ç¨‹](./01-context-engineering.md)
- [ä¸‹ä¸€ç« ï¼šå·¥å…·ç³»ç»Ÿè®¾è®¡ â†’](./03-tool-system.md)
- [è¿”å›ç›®å½•](./00-introduction.md#ç›®å½•)

